
# Private registry

```bash
kubectl create secret docker-registry private-reg-cred --docker-username=dock_user --docker-password=dock_password --docker-server=myprivateregistry.com:5000 --docker-email=dock_user@myprivateregistry.com
```

```yml
apiVersion: apps/v1
kind: Deployment
metadata:
labels:
  app: web
name: web
spec:
  spec:
    imagePullSecrets:
    - name: regcred
    containers:
    - image: myprivateregistry.com:5000/nginx:alpine
      imagePullPolicy: IfNotPresent
```

# CGroups

`/usr/include/linux/capability.h`

```bash
docker run --cap-add
docker run --cap-drop
```

capabilites mentioedn in the docker will override the settings in kubernetes

## Pod level
```yaml
spec:
  securityContext:
    runAsUser: 1000
  containers:
  - name: 
```

## Container level
```yaml
spec:
  containers:
  - name: 
    securityContext:
      runAsUser: 1000
      capabilities:
        add: [""....]
        drop: ["...."]
```

fastest way to create the manifest without saving
```bash
cat <<EOF | kubectl create -f -
> ---
apiVersion: v1
kind: Pod
metadata:
  name: ubuntu-sleeper
  namespace: default
spec:
  securityContext:
    runAsUser: 1010
  containers:
  - command:
    - sleep
    - "4800"
    image: ubuntu
    name: ubuntu-sleeper
> EOF
```

## overriding the pod level to the container level
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: multi-pod
spec:
  securityContext:
    runAsUser: 1001
  containers:
  -  image: ubuntu
     name: web
     command: ["sleep", "5000"]
     securityContext:
      runAsUser: 1002

  -  image: ubuntu
     name: sidecar
     command: ["sleep", "5000"]
```
